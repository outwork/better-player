<html>
<head>
<link href="css/main.css" rel="stylesheet">
<script src="js/template-web.js"></script>
</head>

<body style='margin:0'>
<div id="content"></div>
<script id="bar.html" type="text/html">
<div id='bar'>
    <button>Play/Pause</button>
    <button>Mute/Unmute</button>
    <canvas></canvas>
    <span>00:00 / 11:11</span>
    <div id='float'>
        <button>Settings</button>
        <button>DTube</button>
        <button>Full Screen</button>
    </div>
</div></script><script id="rightmenu.html" type="text/html"><div id='rightmenu'>
    
</div></script><script id="video.html" type="text/html">
<video
    id="video"
    poster="https://snap1.d.tube/ipfs/QmQvJ8J4jFVh4krtHWWgB1xZnzCA7Pgzt45gzxz8mGm94r"
    autoplay=""
    tabindex="-1"
    src="https://video.dtube.top/ipfs/QmSxeVrAZCmeKvvnn1cidFPAAAh3rvjAwrEpQ4ZjPZmUYg">
</video></script>
<script>
document.getElementById('content').innerHTML = 
    template('video.html', {})
    + template('bar.html', {})
    + template('rightmenu.html', {})

video = document.getElementsByTagName('video')[0]
bar = document.getElementById('bar')
rightmenu = document.getElementById('rightmenu')

video.toggle = function() {
    if (video.paused)
        video.play()
    else
        video.pause()
}

video.mute = function() {
    if (video.volume == 0)
        video.volume = 1
    else
        video.volume = 0
}

video.toggleFullscreen = function(event) {
    var isFullscreen = document.webkitIsFullScreen || document.mozFullScreen || false;
    if (isFullscreen)
        video.closeFullscreen()
    else
        video.openFullScreen()
}

video.openFullScreen = function() {
    var html = document.documentElement
    if (html.requestFullscreen) {
        html.requestFullscreen();
      } else if (html.mozRequestFullScreen) {
        html.mozRequestFullScreen();
      } else if (html.webkitRequestFullscreen) {
        html.webkitRequestFullscreen();
      } else if (html.msRequestFullscreen) { 
        html.msRequestFullscreen();
      }
}

video.closeFullscreen = function() {
    if (document.exitFullscreen) {
      document.exitFullscreen();
    } else if (document.mozCancelFullScreen) { /* Firefox */
      document.mozCancelFullScreen();
    } else if (document.webkitExitFullscreen) { /* Chrome, Safari and Opera */
      document.webkitExitFullscreen();
    } else if (document.msExitFullscreen) { /* IE/Edge */
      document.msExitFullscreen();
    }
  }
// window
window.oncontextmenu = (e) => rightmenu.toggle(e)

// video
video.onclick = () => video.toggle()

// bar
bar.getElementsByTagName('button')[0].onclick = () => video.toggle()
bar.getElementsByTagName('button')[1].onclick = () => video.mute()
bar.getElementsByTagName('button')[4].onclick = () => video.toggleFullscreen()

// rightmenu

rightmenu.toggle = function(e) {
    //console.log('right click', rightmenu.style.display, e)
    // pressing alt key disables this menu for the normal menu
    if (e && e.altKey == true)
        return

    if (rightmenu.style.display == 'block')
        rightmenu.style.display = 'none'
    else
        rightmenu.style.display = 'block'

    rightmenu.style.left = e.clientX
    rightmenu.style.top = e.clientY

    e.preventDefault();
}

</script>
</body>
</html>